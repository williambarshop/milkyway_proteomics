<tool id="msconvert_dia_demux" name="DIA Demultiplexing (msconvert)" version="1.0.0">
    <description>Demultiplex DIA file via msconvert</description>
    <command>
    mkdir mzML_input_folder/ &amp;&amp;
    mkdir mzML_output_folder/ &amp;&amp;
    ln -s $input_file mzML_input_folder/${input_file.display_name} &amp;&amp;
    msconvert --mzML --outdir mzML_output_folder/ --outfile temp_output.mzML
    --filter "demultiplex
    massError=${massError}${massErrorUnits}
    optimization=$optimization
<!--    padScanTimes=true
    minWindowSize=0.4
    useMultithreading=true -->
    <!--unimplemented: nnlsMaxIter=<int (50)> nnlsEps=<real (1e-10)> noWeighting=<bool (false)> demuxBlockExtra=<real (0)> variableFill=<bool (false)> noSumNormalize=<bool (false)> -->
    <!-- UsageInfo usage_demux = { "massError=<tolerance and units, eg 0.5Da (default 10ppm)> nnlsMaxIter=<int (50)> nnlsEps=<real (1e-10)> noWeighting=<bool (false)> demuxBlockExtra=<real (0)> variableFill=<bool (false)> noSumNormalize=<bool (false)> optimization=<(none)|overlap_only> padScanTimes=<bool (false)> interpolateRT=<bool (true)> threadLimit=<int (0)> useMultithreading=<bool (false)> minWindowSize=<real (0.2)> -->
    " mzML_input_folder/${input_file.display_name} &amp;&amp;
    mv mzML_output_folder/temp_output.mzML $output_mzml
    </command>
    <inputs>
        <param name="input_file" type="data" format="mzml" multiple="false" label="DIA mzML" help="An mzML file with DIA data"/>
        <param name="massError" type="float" label="Mass Error" value="8.0" min="0.00" max="100.0" />
        <param name="massErrorUnits" type="select" label="Mass Error Units">
        <option value="ppm">ppm</option>
        <option value="Da">Daltons</option>
        </param>

        <param name="optimization" type="select" label="Enable Demux Optimization Type?">
        <option value="overlap_only">Overlap Only</option>
        <option value="none">None</option>
        </param>
    </inputs>
    <outputs>
        <data name="output_mzml" label="$input_file.display_name" format="mzml">
        </data>
    </outputs>
    <help>
     <!-- removed metadata_source="input_file" from the output...-->
    </help>
</tool>

